import com.ats.hrmgt.model.EmpLeaveHistoryRep;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import java.util.List;
public interface EmpLeaveHistoryRepRepo extends JpaRepository<EmpLeaveHistoryRep, String> {


@Query(value = "SELECT\n" + "        UUID() AS rec_id,\n" + "        m_employees.emp_id,\n" + "        CONCAT(m_employees.surname,\n" + "        \" \",\n" + "        m_employees.first_name) AS emp_name,\n" + "        leave_type.lv_type_id,\n" + "        leave_type.lv_title_short,\n" + "        leave_type.lv_title,\n" + "        leave_structure_details.lvs_alloted_leaves,\n" + "        leave_structure_header.lvs_id,\n" + "        coalesce((select\n" + "            b.op_bal          \n" + "        from\n" + "            leave_balance_cal b     \n" + "        where\n" + "            b.emp_id=m_employees.emp_id              \n" + "            and leave_type.lv_type_id=b.lv_type_id              \n" + "            and b.cal_yr_id=leave_structure_allotment.cal_yr_id),\n" + "        0) as bal_leave,\n" + "        coalesce((select\n" + "            sum(b.leave_num_days)          \n" + "        from\n" + "            leave_apply b \n" + "        where\n" + "            b.emp_id=m_employees.emp_id              \n" + "            and leave_type.lv_type_id=b.lv_type_id              \n" + "            and b.cal_yr_id=leave_structure_allotment.cal_yr_id \n" + "            and b.ex_int1=3),\n" + "        0) as saction_leave,\n" + "        coalesce((select\n" + "            sum(b.leave_num_days)          \n" + "        from\n" + "            leave_apply b \n" + "        where\n" + "            b.emp_id=m_employees.emp_id              \n" + "            and leave_type.lv_type_id=b.lv_type_id              \n" + "            and b.cal_yr_id=leave_structure_allotment.cal_yr_id              \n" + "            and b.ex_int1 in (1,2)),\n" + "        0) as apllied_leaeve," + "coalesce((select\n" + "            sum(b.leave_count)                   \n" + "        from\n" + "            t_encash b\n" + "        where\n" + "            b.emp_id=m_employees.emp_id                           \n" + "            and leave_type.lv_type_id=b.lv_type_id                           \n" + "            and b.year_id=leave_structure_allotment.cal_yr_id \n" + "            and b.del_status=1),\n" + "        0) as leave_encash_count         \n" + "    FROM\n" + "        leave_type,\n" + "        m_employees,\n" + "        leave_structure_header,\n" + "        leave_structure_details,\n" + "        leave_structure_allotment      \n" + "    WHERE\n" + "        m_employees.emp_id = leave_structure_allotment.emp_id          \n" + "        AND leave_structure_allotment.lvs_id = leave_structure_header.lvs_id          \n" + "        AND leave_structure_header.lvs_id = leave_structure_details.lvs_id          \n" + "        AND leave_structure_details.lv_type_id = leave_type.lv_type_id                   \n" + "        and leave_structure_allotment.cal_yr_id=:calYrId          \n" + "        and leave_type.del_status=1 and m_employees.location_id=:locId", nativeQuery = true)
public List<EmpLeaveHistoryRep> getEmpLeaveHistoryRepAll(int calYrId,int locId)


@Query(value = " SELECT\n" + "\n" + " UUID() AS rec_id,m_employees.emp_id,\n" + "    CONCAT(m_employees.surname, \" \", m_employees.first_name) AS emp_name,\n" + "        leave_type.lv_type_id,\n" + "        leave_type.lv_title_short,\n" + "        leave_type.lv_title,\n" + "        leave_structure_details.lvs_alloted_leaves,\n" + "        leave_structure_header.lvs_id,\n" + "        coalesce((select\n" + "            b.op_bal \n" + "        from\n" + "            leave_balance_cal b \n" + "        where\n" + "            b.emp_id=m_employees.emp_id \n" + "            and leave_type.lv_type_id=b.lv_type_id \n" + "            and b.cal_yr_id=leave_structure_allotment.cal_yr_id  ),\n" + "        0) as bal_leave,\n" + "        coalesce((select\n" + "            sum(b.leave_num_days) \n" + "        from\n" + "            leave_apply b  \n" + "        where\n" + "            b.emp_id=m_employees.emp_id \n" + "            and leave_type.lv_type_id=b.lv_type_id \n" + "            and b.cal_yr_id=leave_structure_allotment.cal_yr_id  \n" + "            and b.ex_int1=3),\n" + "        0) as saction_leave,\n" + "        coalesce((select\n" + "            sum(b.leave_num_days) \n" + "        from\n" + "            leave_apply b  \n" + "        where\n" + "            b.emp_id=m_employees.emp_id \n" + "            and leave_type.lv_type_id=b.lv_type_id \n" + "            and b.cal_yr_id=leave_structure_allotment.cal_yr_id" + " and b.ex_int1 in (1,2)),\n" + "        0) as apllied_leaeve," + " coalesce((select\n" + "            sum(b.leave_count)                   \n" + "        from\n" + "            t_encash b                  \n" + "        where\n" + "            b.emp_id=m_employees.emp_id                           \n" + "            and leave_type.lv_type_id=b.lv_type_id                           \n" + "            and b.year_id=leave_structure_allotment.cal_yr_id   \n" + "            and b.del_status=1),\n" + "        0) as leave_encash_count   \n" + "    FROM\n" + "        leave_type,\n" + "        m_employees,\n" + "        leave_structure_header,\n" + "        leave_structure_details,\n" + "        leave_structure_allotment \n" + "    WHERE\n" + "        m_employees.emp_id = leave_structure_allotment.emp_id \n" + "        AND leave_structure_allotment.lvs_id = leave_structure_header.lvs_id \n" + "        AND leave_structure_header.lvs_id = leave_structure_details.lvs_id \n" + "        AND leave_structure_details.lv_type_id = leave_type.lv_type_id \n" + "        AND m_employees.emp_id=:empId \n" + "        and leave_structure_allotment.cal_yr_id=:calYrId \n" + "        and leave_type.del_status=1 and m_employees.location_id=:locId", nativeQuery = true)
public List<EmpLeaveHistoryRep> getEmpLeaveHistoryRep(int empId,int calYrId,int locId)


}